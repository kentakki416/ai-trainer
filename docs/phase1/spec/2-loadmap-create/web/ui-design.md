# 目標設定・ロードマップ作成機能 - UI設計書

## 1. 画面構成

この機能は主に初回オンボーディング画面で実装されます。

| 画面名 | パス | 目的 |
|-------|------|------|
| 初回設定（オンボーディング） | `/onboarding` | 目標設定・AI分析・ロードマップ確認 |
| タスク入力モーダル | モーダル | 日々のタスク記録 |

---

## 2. 初回設定画面（`/onboarding`）

### 2.1 Step 1: 目標入力

**レイアウト**:
```
┌─────────────────────────────────────┐
│ ← スキップ       ステップ 1/4        │
├─────────────────────────────────────┤
│                                     │
│  あなたの目標を教えてください        │
│                                     │
│  目標内容                            │
│  ┌───────────────────────────────┐ │
│  │ 例: TOEIC 800点取得            │ │
│  └───────────────────────────────┘ │
│                                     │
│  達成希望日                          │
│  ┌───────────────────────────────┐ │
│  │ 📅 2025-12-31                 │ │
│  └───────────────────────────────┘ │
│                                     │
│  目標カテゴリ                        │
│  ┌───────────────────────────────┐ │
│  │ 📚 資格 ▼                     │ │
│  └───────────────────────────────┘ │
│                                     │
│         ┌──────────────┐           │
│         │   次へ →    │           │
│         └──────────────┘           │
│                                     │
└─────────────────────────────────────┘
```

**構成要素**:
- ヘッダー: 戻るボタン（スキップ）、ステップインジケーター
- 目標入力フィールド
  - プレースホルダー: 「例: TOEIC 800点取得」
  - 最大文字数: 255文字
- 達成希望日ピッカー
  - カレンダーUIで日付選択
  - デフォルト: 3ヶ月後
- 目標カテゴリドロップダウン
  - 選択肢: 資格、学習、スキル、その他
- 次へボタン（CTA）

**バリデーション**:
- 目標内容: 必須、1文字以上
- 達成希望日: 必須、今日より後の日付

**画面遷移**:
- 次へ → Step 2（現在の状況入力）
- スキップ → ホーム画面（目標未設定状態）

---

### 2.2 Step 2: 現在の状況入力

**レイアウト**:
```
┌─────────────────────────────────────┐
│ ← 戻る          ステップ 2/4         │
├─────────────────────────────────────┤
│                                     │
│  現在の状況を教えてください          │
│                                     │
│  現在のレベル                        │
│  ┌───────────────────────────────┐ │
│  │ 例: TOEIC 200点                │ │
│  └───────────────────────────────┘ │
│                                     │
│  その他の情報（任意）                │
│  ┌───────────────────────────────┐ │
│  │ 平日は1時間、週末は2時間学習可  │ │
│  │ 能です                         │ │
│  └───────────────────────────────┘ │
│                                     │
│         ┌──────────────┐           │
│         │ AI分析開始 → │           │
│         └──────────────┘           │
│                                     │
└─────────────────────────────────────┘
```

**構成要素**:
- 現在のレベル入力フィールド
  - プレースホルダー: 「例: TOEIC 200点」
  - 必須入力
- 追加情報テキストエリア
  - プレースホルダー: 「平日は1時間、週末は2時間学習可能です」
  - 任意入力
- AI分析開始ボタン

**バリデーション**:
- 現在のレベル: 必須、1文字以上

**画面遷移**:
- 戻る → Step 1
- AI分析開始 → Step 3（AI分析中）

---

### 2.3 Step 3: AI分析中

**レイアウト**:
```
┌─────────────────────────────────────┐
│              ステップ 3/4            │
├─────────────────────────────────────┤
│                                     │
│    [キャラクターアニメーション]      │
│         トレちゃんが考え中...        │
│                                     │
│   AIが目標を分析しています...       │
│                                     │
│      ━━━━━━━━━━━━ 75%            │
│                                     │
│   推定学習時間を計算中...           │
│                                     │
└─────────────────────────────────────┘
```

**構成要素**:
- キャラクターアニメーション
  - トレちゃんが考えているアニメーション
  - Lottieアニメーションを使用
- プログレスバー
  - 0%から100%まで徐々に進行
  - 処理状況テキストを動的に更新
- 処理状況メッセージ
  - 「目標を分析中...」
  - 「推定学習時間を計算中...」
  - 「中間ゴールを生成中...」

**処理**:
1. バックエンドにAI分析リクエスト送信
2. ポーリングで進行状況を取得
3. 完了したら自動的に Step 4 に遷移

**画面遷移**:
- AI分析完了 → Step 4（結果確認）

---

### 2.4 Step 4: AI分析結果の確認

**レイアウト**:
```
┌─────────────────────────────────────┐
│ ← 戻る          ステップ 4/4         │
├─────────────────────────────────────┤
│  🎯 目標: TOEIC 800点取得           │
│  📅 達成日: 2025-12-31              │
│                                     │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                     │
│  📊 AI分析結果                      │
│                                     │
│  ⏱️  推定学習時間: 200時間           │
│  📚 1日の推奨学習: 30分〜1時間       │
│                                     │
│  学習時間の内訳:                     │
│  • 英単語: 60時間                   │
│  • 文法: 40時間                     │
│  • リスニング: 60時間               │
│  • リーディング: 40時間             │
│                                     │
│  💡 推奨事項:                       │
│  • 毎日30分以上の学習を推奨         │
│  • 週に1回は模擬試験を受けると効果的│
│                                     │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                     │
│  🏁 中間ゴール (3つ)                │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ✓ 英単語1000語                 │ │
│  │   目標日: 2025-02-15           │ │
│  │   推定: 30時間                 │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ✓ TOEIC 650点                  │ │
│  │   目標日: 2025-05-01           │ │
│  │   推定: 100時間                │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ✓ TOEIC 750点                  │ │
│  │   目標日: 2025-09-01           │ │
│  │   推定: 180時間                │ │
│  └───────────────────────────────┘ │
│                                     │
│      ✏️ 中間ゴールを編集            │
│                                     │
│         ┌──────────────┐           │
│         │  開始する!   │           │
│         └──────────────┘           │
│                                     │
└─────────────────────────────────────┘
```

**構成要素**:
1. **目標サマリー**:
   - 目標タイトル
   - 達成希望日

2. **AI分析結果カード**:
   - 推定学習時間
   - 1日の推奨学習時間
   - 学習時間の内訳（円グラフまたはバー表示）
   - 推奨事項リスト

3. **中間ゴールリスト**:
   - 各中間ゴールをカードで表示
   - タイトル、目標日、推定時間
   - チェックマーク（確認済み）

4. **中間ゴールを編集ボタン**:
   - タップでモーダル表示
   - 追加/編集/削除/並び替え可能

5. **開始するボタン（CTA）**:
   - タップで目標を確定してホーム画面へ

**インタラクション**:
- 中間ゴールカードをタップ → 詳細表示・編集
- 中間ゴールを編集 → モーダルで編集画面表示
- 開始する → 目標確定、ホーム画面へ遷移

**画面遷移**:
- 戻る → Step 2（AI分析やり直し）
- 開始する → ホーム画面

---

## 3. 中間ゴール編集モーダル

**レイアウト**:
```
┌─────────────────────────────────────┐
│  中間ゴールを編集     ✕ 閉じる      │
├─────────────────────────────────────┤
│                                     │
│  ⚠️  中間ゴールは後から変更できます  │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 🔘 1. 英単語1000語             │ │
│  │    目標日: 2025-02-15          │ │
│  │    推定: 30時間                │ │
│  │    [編集] [削除]               │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 🔘 2. TOEIC 650点              │ │
│  │    目標日: 2025-05-01          │ │
│  │    推定: 100時間               │ │
│  │    [編集] [削除]               │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ➕ 中間ゴールを追加             │ │
│  └───────────────────────────────┘ │
│                                     │
│         ┌──────────────┐           │
│         │   保存する   │           │
│         └──────────────┘           │
│                                     │
└─────────────────────────────────────┘
```

**機能**:
- ドラッグ&ドロップで順序変更
- 各ゴールの編集・削除
- 新規中間ゴール追加
- 保存ボタンで確定

---

## 4. タスク入力モーダル（簡易入力）

**レイアウト**:
```
┌─────────────────────────────────────┐
│  今日のタスク        ✕ 閉じる       │
├─────────────────────────────────────┤
│                                     │
│  📅 2025-12-10 (今日)               │
│                                     │
│  AI提案タスク:                      │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ☐ 英単語30個暗記 (30分)        │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ☑ 文法問題20問 (30分)          │ │
│  └───────────────────────────────┘ │
│                                     │
│  ➕ タスクを追加                    │
│                                     │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                     │
│  合計学習時間: 30分                 │
│                                     │
│         ┌──────────────┐           │
│         │ 完了を記録   │           │
│         └──────────────┘           │
│                                     │
│      ✏️ 詳細を入力する              │
│                                     │
└─────────────────────────────────────┘
```

**構成要素**:
1. **日付表示**:
   - デフォルト: 今日
   - タップで日付選択可能

2. **タスクチェックリスト**:
   - AI提案タスクを表示
   - チェックボックスで完了マーク
   - 推定時間を表示

3. **タスク追加ボタン**:
   - タップで新規タスク入力

4. **合計学習時間**:
   - チェックしたタスクの合計時間を表示

5. **完了を記録ボタン**:
   - タップで記録を保存
   - キャラクター成長アニメーション表示

6. **詳細を入力するリンク**:
   - タップで詳細入力モードに切り替え

**インタラクション**:
- タスクにチェック → 合計時間が更新される
- タスクを追加 → テキストフィールド表示
- 完了を記録 → 保存 + 成長アニメーション
- 詳細を入力 → 詳細入力モードに切り替え

---

## 5. タスク入力モーダル（詳細入力）

**レイアウト**:
```
┌─────────────────────────────────────┐
│  進捗を記録          ✕ 閉じる       │
├─────────────────────────────────────┤
│                                     │
│  📅 日付: 2025-12-10 (今日) ▼       │
│                                     │
│  学習内容                            │
│  ┌───────────────────────────────┐ │
│  │ 英単語100個暗記                │ │
│  │ リスニング練習30分             │ │
│  └───────────────────────────────┘ │
│                                     │
│  学習時間                            │
│  ┌─────┐ 時間  ┌─────┐ 分        │
│  │  1  │      │ 30  │            │
│  └─────┘      └─────┘            │
│                                     │
│  達成度                              │
│  😞  😐  🙂  😊  😄              │
│  1    2   3   4   5               │
│           ↑ 選択中                  │
│                                     │
│  メモ（任意）                        │
│  ┌───────────────────────────────┐ │
│  │ 予想より難しかった...          │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │      💾 保存する              │ │
│  └───────────────────────────────┘ │
│                                     │
│      🔄 簡易入力に戻る              │
│                                     │
└─────────────────────────────────────┘
```

**構成要素**:
1. **日付選択**:
   - カレンダーピッカー
   - 過去の日付も選択可能

2. **学習内容テキストエリア**:
   - 複数行入力可能
   - 必須入力

3. **学習時間入力**:
   - 時間と分を別々に入力
   - 数値入力フィールド

4. **達成度選択**:
   - 絵文字で1〜5段階
   - タップで選択

5. **メモフィールド**:
   - 任意入力
   - プレースホルダー: 「今日の感想や気づき」

6. **保存ボタン**:
   - タップで記録を保存
   - バリデーションエラー表示

7. **簡易入力に戻るリンク**:
   - タップでモード切り替え

**バリデーション**:
- 学習内容: 必須、1文字以上
- 学習時間: 必須、0より大きい値

---

## 6. レスポンシブ対応

### モバイル（〜768px）
- 1カラムレイアウト
- タップしやすいボタンサイズ（最低44px）
- フォントサイズ: 16px以上（ズーム防止）
- モーダルは画面全体に表示

### タブレット・デスクトップ
- モーダルは最大幅600px
- センター寄せ表示
- マウスホバー効果を追加

---

## 7. アニメーション・フィードバック

### マイクロインタラクション
1. **タスクチェック時**:
   - チェックマークアニメーション
   - 完了タスクは薄く表示

2. **中間ゴール編集時**:
   - ドラッグ中は影を強調
   - 削除時はスライドアウト

3. **AI分析完了時**:
   - 結果カードがフェードイン
   - 紙吹雪エフェクト（オプション）

### 成長演出
1. **記録保存後**:
   - キャラクターが喜ぶアニメーション
   - 経験値獲得エフェクト
   - レベルアップ時は特別演出

---

## 8. エラー処理

### AI分析失敗時
```
┌─────────────────────────────────────┐
│                                     │
│    😢 AI分析に失敗しました          │
│                                     │
│    申し訳ございません。              │
│    もう一度お試しください。          │
│                                     │
│         ┌──────────────┐           │
│         │  再試行する  │           │
│         └──────────────┘           │
│                                     │
│      または後で設定する              │
│                                     │
└─────────────────────────────────────┘
```

### 月間AI分析制限超過時
```
┌─────────────────────────────────────┐
│                                     │
│    ⚠️  AI分析の上限に達しました      │
│                                     │
│    無料プランでは月3回まで           │
│    AI分析を利用できます。            │
│                                     │
│    次回リセット: 2025-01-01          │
│                                     │
│         ┌──────────────┐           │
│         │    閉じる    │           │
│         └──────────────┘           │
│                                     │
└─────────────────────────────────────┘
```

---

## 9. アクセシビリティ

- **フォーカス管理**: モーダル表示時に最初の入力フィールドにフォーカス
- **Escキー**: モーダルを閉じる
- **ARIA属性**: 適切なラベル付け
- **キーボード操作**: Tabキーで順次移動可能

---

**作成日**: 2025-12-02
**最終更新日**: 2025-12-02
**バージョン**: 1.0
